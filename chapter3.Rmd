---
title: "Week 3 Analysis - Logistic Regression"
author: "Juho Lähteenmaa"
date: "13 November 2018"
---

# Import data

Read data from own data folder.

```{r}
alc <- read.csv("C:/Users/juhol/OneDrive/Documents/GitHub/IODS-project/data/alc.csv", header = T, sep = ",")

alc <- alc[,-1] # First column only duplicates the row numbers

dim(alc)

str(alc)

summary(alc)
```

Data icludes 382 observations and 35 variables. Data is combined from two datasets which are loaded from [here][id1]. Site includes also the meta text for data which is usefull to read. R-code for data wrangling can be found in [here][id2] and data is available in [here][id3]. 
 
[id1]:https://archive.ics.uci.edu/ml/machine-learning-databases/00320/
[id2]:https://github.com/juholaht/IODS-project/blob/master/data/create_alc.R
[id3]:https://github.com/juholaht/IODS-project/blob/master/data/alc.csv


# Analysis

Packages used in this section:

```{r, error=FALSE, warning=FALSE, message=FALSE}
library(dplyr)
library(tidyverse)
library(ggplot2)
library(GGally)

library(car)
library(sandwich)
library(lmtest)
```


Lets introduce the column names of our data.

```{r}
colnames(alc)
```

In our analyse section we are interested in relationships between alcohol consumption and social parameters. Lets choose variable "high use of alcohol" (binary) as the dependent variable of interest and "extra-curricular activities" (binary), "romantic relationship" (binary), "quality of family relationships" (numeric: from 1 - very bad to 5 - excellent) and "going out with friends" (numeric: from 1 - very low to 5 - very high) as social parameters of interest. Lets also control the age and sex.

```{r}
# Lets make subset of data with variables "sex", "age", "activities", "romantic", "famrel", "goout" and "high_use".

variables_sub <- c("sex", "age", "activities", "romantic", "famrel", "goout", "high_use")

alc_sub <- select(alc, one_of(variables_sub))

str(alc_sub)

```

Lets plot alcohol use which each of these variables.

```{r}
alc_sex <- ggplot(data = alc_sub, aes(x = sex, fill = high_use)) + geom_bar() + ggtitle("Student consumption of alcohol and sex")

alc_sex


alc_age <- ggplot(data = alc_sub, aes(x = age, fill = high_use)) + geom_bar() + ggtitle("Student consumption of alcohol and age")

alc_age

alc_act <- ggplot(data = alc_sub, aes(x = activities, fill = high_use)) + geom_bar() + ggtitle("Student consumption of alcohol and activities")

alc_act

alc_rom <- ggplot(data = alc_sub, aes(x = romantic, fill = high_use)) + geom_bar() + ggtitle("Student consumption of alcohol and romantic relationship")

alc_rom






```

